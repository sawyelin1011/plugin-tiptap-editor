{"version":3,"file":"index.js","sources":["../src/index.ts"],"sourcesContent":["/**\r\n * TipTap Editor Plugin\r\n * Rich text editor with markdown support\r\n * Built-in plugin for GSM Flow CMS\r\n */\r\n\r\nimport { definePlugin, EXTENSION_POINTS, type PluginContext } from '@gsmflow/plugin-sdk';\r\n\r\nexport default definePlugin({\r\n\tid: 'tiptap-editor',\r\n\tname: 'TipTap Editor',\r\n\tversion: '1.0.0',\r\n\tpermissions: ['cms.write'],\r\n\r\n\tsetup(registry) {\r\n\t\t// Register as CMS editor\r\n\t\tregistry.register(EXTENSION_POINTS.CMS.EDITOR_TOOLBAR, {\r\n\t\t\tpriority: 1,\r\n\t\t\thandler: async (_context: PluginContext, _data: unknown) => {\r\n\t\t\t\treturn {\r\n\t\t\t\t\ttype: 'toolbar-items',\r\n\t\t\t\t\titems: [\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tid: 'bold',\r\n\t\t\t\t\t\t\tlabel: 'Bold',\r\n\t\t\t\t\t\t\taction: 'toggleBold',\r\n\t\t\t\t\t\t\tshortcut: 'Mod-B'\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tid: 'italic',\r\n\t\t\t\t\t\t\tlabel: 'Italic',\r\n\t\t\t\t\t\t\taction: 'toggleItalic',\r\n\t\t\t\t\t\t\tshortcut: 'Mod-I'\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tid: 'underline',\r\n\t\t\t\t\t\t\tlabel: 'Underline',\r\n\t\t\t\t\t\t\taction: 'toggleUnderline',\r\n\t\t\t\t\t\t\tshortcut: 'Mod-U'\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tid: 'strike',\r\n\t\t\t\t\t\t\tlabel: 'Strikethrough',\r\n\t\t\t\t\t\t\taction: 'toggleStrike',\r\n\t\t\t\t\t\t\tshortcut: 'Mod-Shift-X'\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t{ type: 'separator' },\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tid: 'heading1',\r\n\t\t\t\t\t\t\tlabel: 'Heading 1',\r\n\t\t\t\t\t\t\taction: 'toggleHeading',\r\n\t\t\t\t\t\t\tparams: { level: 1 },\r\n\t\t\t\t\t\t\tshortcut: 'Mod-Alt-1'\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tid: 'heading2',\r\n\t\t\t\t\t\t\tlabel: 'Heading 2',\r\n\t\t\t\t\t\t\taction: 'toggleHeading',\r\n\t\t\t\t\t\t\tparams: { level: 2 },\r\n\t\t\t\t\t\t\tshortcut: 'Mod-Alt-2'\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tid: 'heading3',\r\n\t\t\t\t\t\t\tlabel: 'Heading 3',\r\n\t\t\t\t\t\t\taction: 'toggleHeading',\r\n\t\t\t\t\t\t\tparams: { level: 3 },\r\n\t\t\t\t\t\t\tshortcut: 'Mod-Alt-3'\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t{ type: 'separator' },\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tid: 'bulletList',\r\n\t\t\t\t\t\t\tlabel: 'Bullet List',\r\n\t\t\t\t\t\t\taction: 'toggleBulletList',\r\n\t\t\t\t\t\t\tshortcut: 'Mod-Shift-8'\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tid: 'orderedList',\r\n\t\t\t\t\t\t\tlabel: 'Numbered List',\r\n\t\t\t\t\t\t\taction: 'toggleOrderedList',\r\n\t\t\t\t\t\t\tshortcut: 'Mod-Shift-7'\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tid: 'blockquote',\r\n\t\t\t\t\t\t\tlabel: 'Quote',\r\n\t\t\t\t\t\t\taction: 'toggleBlockquote',\r\n\t\t\t\t\t\t\tshortcut: 'Mod-Shift-B'\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t{ type: 'separator' },\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tid: 'link',\r\n\t\t\t\t\t\t\tlabel: 'Link',\r\n\t\t\t\t\t\t\taction: 'toggleLink',\r\n\t\t\t\t\t\t\tshortcut: 'Mod-K'\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tid: 'image',\r\n\t\t\t\t\t\t\tlabel: 'Image',\r\n\t\t\t\t\t\t\taction: 'insertImage'\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tid: 'code',\r\n\t\t\t\t\t\t\tlabel: 'Code',\r\n\t\t\t\t\t\t\taction: 'toggleCode',\r\n\t\t\t\t\t\t\tshortcut: 'Mod-E'\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tid: 'codeBlock',\r\n\t\t\t\t\t\t\tlabel: 'Code Block',\r\n\t\t\t\t\t\t\taction: 'toggleCodeBlock',\r\n\t\t\t\t\t\t\tshortcut: 'Mod-Alt-C'\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t{ type: 'separator' },\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tid: 'undo',\r\n\t\t\t\t\t\t\tlabel: 'Undo',\r\n\t\t\t\t\t\t\taction: 'undo',\r\n\t\t\t\t\t\t\tshortcut: 'Mod-Z'\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tid: 'redo',\r\n\t\t\t\t\t\t\tlabel: 'Redo',\r\n\t\t\t\t\t\t\taction: 'redo',\r\n\t\t\t\t\t\t\tshortcut: 'Mod-Shift-Z'\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t]\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t// Register CMS field type\r\n\t\tregistry.register(EXTENSION_POINTS.CMS.FIELD, {\r\n\t\t\tpriority: 1,\r\n\t\t\thandler: async (context: PluginContext, data: unknown) => {\r\n\t\t\t\tconst fieldData = data as { type: string; config?: Record<string, unknown> };\r\n\r\n\t\t\t\tif (fieldData.type !== 'richtext') {\r\n\t\t\t\t\treturn null;\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn {\r\n\t\t\t\t\ttype: 'richtext',\r\n\t\t\t\t\tcomponent: 'TipTapEditor',\r\n\t\t\t\t\tconfig: {\r\n\t\t\t\t\t\tplaceholder: fieldData.config?.placeholder || 'Start typing...',\r\n\t\t\t\t\t\tminHeight: fieldData.config?.minHeight || 200,\r\n\t\t\t\t\t\tmaxHeight: fieldData.config?.maxHeight || 600,\r\n\t\t\t\t\t\tenableMarkdown: fieldData.config?.enableMarkdown !== false,\r\n\t\t\t\t\t\tenableImages: fieldData.config?.enableImages !== false,\r\n\t\t\t\t\t\tenableLinks: fieldData.config?.enableLinks !== false,\r\n\t\t\t\t\t\tenableCodeBlocks: fieldData.config?.enableCodeBlocks !== false\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t// Register shortcode for embedding rich content\r\n\t\tregistry.register(EXTENSION_POINTS.CMS.SHORTCODE, {\r\n\t\t\tpriority: 1,\r\n\t\t\thandler: async (context: PluginContext, data: unknown) => {\r\n\t\t\t\tconst shortcodeData = data as {\r\n\t\t\t\t\tname: string;\r\n\t\t\t\t\tattributes: Record<string, string>;\r\n\t\t\t\t\tcontent?: string;\r\n\t\t\t\t};\r\n\r\n\t\t\t\tif (shortcodeData.name !== 'richtext') {\r\n\t\t\t\t\treturn null;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Render rich text content\r\n\t\t\t\tconst content = shortcodeData.content || '';\r\n\t\t\t\tconst className = shortcodeData.attributes.class || 'prose';\r\n\r\n\t\t\t\treturn `<div class=\"${className}\">${content}</div>`;\r\n\t\t\t}\r\n\t\t});\r\n\t},\r\n\r\n\tasync onInstall(context: PluginContext) {\r\n\t\tcontext.log.info('TipTap Editor plugin installed');\r\n\r\n\t\t// Check permissions\r\n\t\tif (!context.hasPermission('cms.write')) {\r\n\t\t\tcontext.log.warn('Plugin installed without cms:write permission');\r\n\t\t}\r\n\t},\r\n\r\n\tasync onEnable(context: PluginContext) {\r\n\t\tcontext.log.info('TipTap Editor plugin enabled');\r\n\t},\r\n\r\n\tasync onDisable(context: PluginContext) {\r\n\t\tcontext.log.info('TipTap Editor plugin disabled');\r\n\t},\r\n\r\n\tasync onUninstall(context: PluginContext) {\r\n\t\tcontext.log.info('TipTap Editor plugin uninstalled');\r\n\t}\r\n});\r\n"],"names":["index","definePlugin","registry","EXTENSION_POINTS","_context","_data","context","data","fieldData","shortcodeData","content"],"mappings":"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"}